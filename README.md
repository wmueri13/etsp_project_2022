# Essentials in Text and Speech Processing - NLP Project

## Binary Classification of Stock Market Intraday Returns with a BERT-based Model

## Developers (University of Zurich)
Wesley Müri

Turki Alahmadi

## Documentation
- All relevant results can be directly seen in the repository.
- Code is designed in a modular fashion and functions can be individually used when sequentially loaded/read.
- The relevant data JSON's news_history.json and price_daily.json have to be copied directly into the directory for the code to work. These datasets are loaded from the iexCloud API (https://iexcloud.io/docs/api/) from the sources "Historical News" and "Historical Prices".
- Our own price_daily.json extracted only relevant dictionary pairs from the dataset in order to improve storage efficiency, whereas news_history.json features the all the available dictionary pairs.


## Introduction (Thesis Excerpt)
Stock market prediction has gained a noticeable interest in the past two decades. The rapid progression in NLP research has enabled researchers to use text-based tools instead of only relying on quantifiable predictors. Most of the recent research papers have focused on financial news sentiment analysis to predict price movement. This focus is a result of the positive outcomes of sentiment analysis in this area [1,2]. Many of the research papers in this area used classical machine learning approaches such as SVM and NB [3]. In this project, however, we have taken a different approach to predict the stock market behavior. Instead of correlating the sentiment to the stock price, we tried to predict the intraday return of a stock based on the news feeds directly. The intraday return is the return generated by a stock during regular trading hours, based on its price change from the close of a trading day to the close of the next one [4]. We fine-tuned a pre-trained BERT-based model and used binary classification to determine if a stock price will increase by some preset threshold (percentage). The news feeds are labeled positive if the stock price change in the next day exceeds the threshold value, and are labeled negative otherwise. Depending on the threshold value, the model can predict different scenarios. For instance, one can train the model to predict if a major price increase would occur by setting the threshold to a significant positive value such as 0.01. This would tell the model to ignore minor price fluctuations, and only consider the news positive if the price increases by 1% or more. If the threshold is set to zero, any price increase is positive and any decrease is negative. We trained the model on different thresholds: -0.01, 0.01 and 0.03. The positive values were chosen to detect significant price increase, while the negative one would predict significant decrease. Moreover, we were interested in how the model predictions relate to the sentiment scores of the news feeds and if sentiment analysis can improve the model further. Thus, we compared the model scores and the binary sentiment scores obtained from a fine-tuned HuggingFace model for sentiment analysis. Then we created a trading bot simulation to model and compare the effect of multiple trading behaviors. We modeled a benchmark behavior and compared it to two other behaviors in which the trader makes decisions based on our model’s outcome or a modified version of our model that accounts for sentiment analysis results as well.

## References (Intro)
[1] Patrick Uhr, M. F., and J. Zenkert. "Sentiment analysis in financial market." IEEE International Conference  System Man, Cybernetics. 2014.
[2] Pagolu, Venkata Sasank, et al. "Sentiment analysis of Twitter data for predicting stock market movements." 2016 international conference on signal processing, communication, power and embedded system (SCOPES). IEEE, 2016.
[3] De Fortuny, Enric Junqué, et al. "Evaluating and understanding text-based stock price prediction models." Information Processing & Management 50.2 (2014): 426-441.
[4] Kenton, Will. “Intraday Return Definition.” Edited by Akhilesh Ganti, Investopedia, 18 Sept. 2022, https://www.investopedia.com/terms/i/intraday-return.asp. 
